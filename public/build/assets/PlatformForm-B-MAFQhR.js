import{r as n,j as e,$ as k,S as _}from"./app-DjJX563G.js";import{d as C,B as o,g as S}from"./createLucideIcon-D933E3G3.js";import{C as w}from"./checkbox-SLDZIGJF.js";import{I as g}from"./input-gwDjpgU_.js";import{S as F}from"./scroll-area-Br0mcb7x.js";function A({data:l,setData:r,errors:i,processing:h,submitButtonText:p,onSubmit:f,companies:b=[],selectedCompanyIds:a=[]}){console.log(l);const m=n.useRef(!1),[j,y]=n.useState(!0),[u,d]=n.useState(!1),x=n.useCallback(C(s=>{m.current||r("slug",S(s))},300),[]);n.useEffect(()=>{if(j){y(!1);return}x(l.name)},[l.name,x]),n.useEffect(()=>{a.length>0&&r("company_ids",a)},[a,r]);const N=s=>{const t=l.company_ids||[];t.includes(s)?r("company_ids",t.filter(c=>c!==s)):r("company_ids",[...t,s])},v=()=>{l.id&&(d(!0),_.post(route("platforms.regenerate-key",l.id),{},{onSuccess:s=>{var c;const t=(c=s.props)==null?void 0:c.platform;t&&typeof t.secret_key=="string"&&r("secret_key",t.secret_key),d(!1)},onError:s=>{console.error("Failed to regenerate secret key:",s),d(!1)}}))};return e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"name",className:"mb-1 block text-sm",children:"Name"}),e.jsx(g,{id:"name",type:"text",className:"w-full rounded-md border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none",value:l.name,onChange:s=>r("name",s.target.value)}),i.name&&e.jsx("div",{className:"mt-1 text-sm text-red-600",children:i.name})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"slug",className:"mb-1 block text-sm",children:"Slug"}),e.jsx(g,{id:"slug",type:"text",className:"w-full rounded-md border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none",value:l.slug,onChange:s=>{m.current=!0,r("slug",s.target.value)}}),i.slug&&e.jsx("div",{className:"mt-1 text-sm text-red-600",children:i.slug})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"description",className:"mb-1 block text-sm",children:"Description"}),e.jsx("textarea",{id:"description",className:"w-full rounded-md border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none",value:l.description,onChange:s=>r("description",s.target.value),rows:4}),i.description&&e.jsx("div",{className:"mt-1 text-sm text-red-600",children:i.description})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"url",className:"mb-1 block text-sm",children:"URL"}),e.jsx("input",{id:"url",type:"text",className:"w-full rounded-md border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none",value:l.url||"",onChange:s=>{r("url",s.target.value)},placeholder:"Enter URL"}),i.url&&e.jsx("div",{className:"mt-1 text-sm text-red-600",children:i.url})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"secret_key",className:"mb-1 block text-sm",children:"Secret Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"secret_key",type:"text",className:"w-full rounded-md border border-gray-300 bg-gray-50 px-4 py-2 font-mono text-sm",value:l.secret_key||"",readOnly:!0}),e.jsx(o,{type:"button",variant:"outline",onClick:v,disabled:u||!l.id,children:u?"Regenerating...":"Regenerate"})]}),!l.id&&e.jsx("div",{className:"mt-1 text-xs text-gray-500",children:"A secure secret key will be automatically generated when the platform is created."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"companies",className:"mb-1 block text-sm",children:"Companies"}),e.jsx("div",{className:"rounded-md border p-2",children:e.jsx(F,{className:"h-60 w-full",children:e.jsx("div",{className:"space-y-2 p-2",children:b.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:`company-${s.id}`,checked:(l.company_ids||[]).includes(s.id),onCheckedChange:()=>N(s.id)}),e.jsx("label",{htmlFor:`company-${s.id}`,className:"cursor-pointer text-sm",children:s.name})]},s.id))})})}),i.company_ids&&e.jsx("div",{className:"mt-1 text-sm text-red-600",children:i.company_ids})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"mr-2 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",checked:l.is_active,onChange:s=>r("is_active",s.target.checked)}),e.jsx("span",{className:"font-medium",children:"Active"})]}),i.is_active&&e.jsx("div",{className:"mt-1 text-sm text-red-600",children:i.is_active})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(k,{href:route("platforms.index"),children:e.jsx(o,{type:"button",variant:"outline",children:"Cancel"})}),e.jsx(o,{type:"submit",disabled:h,children:p})]})]})}export{A as P};
