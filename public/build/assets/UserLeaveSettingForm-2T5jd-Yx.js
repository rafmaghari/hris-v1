import{m as z,r as H,t as m,j as a}from"./app-C84IgD_F.js";import{B as R}from"./createLucideIcon-1iKnX0P3.js";import{C as $,a as G,b as J,c as K}from"./card-D2SlVg6H.js";import{C as P}from"./checkbox-ms9-Q6AU.js";import{I as o}from"./input-DsAprXuv.js";import{L as t}from"./label-DtNMNcRI.js";import{S as n,a as _,b as x,c as p,d as u}from"./select-gXvW7wEd.js";function aa({userLeaveSetting:s,users:T,leaveSettingsTemplates:h,accrualTypes:V,accrualFrequencies:B,isEditing:i=!1}){var b,v,N,f,g,C,F,w,q;const{data:l,setData:r,post:E,put:I,processing:y,errors:c,reset:M}=z({user_id:((b=s==null?void 0:s.user_id)==null?void 0:b.toString())||"",leave_settings_template_id:((v=s==null?void 0:s.leave_settings_template_id)==null?void 0:v.toString())||"",start_date:(s==null?void 0:s.start_date)||"",end_date:(s==null?void 0:s.end_date)||"",accrual_type:((N=s==null?void 0:s.accrual_type)==null?void 0:N.toString())||"",accrual_frequency:((f=s==null?void 0:s.accrual_frequency)==null?void 0:f.toString())||"",accrual_amount:((g=s==null?void 0:s.accrual_amount)==null?void 0:g.toString())||"",max_cap:((C=s==null?void 0:s.max_cap)==null?void 0:C.toString())||"",max_carry_over:((F=s==null?void 0:s.max_carry_over)==null?void 0:F.toString())||"0",current_balance:((w=s==null?void 0:s.current_balance)==null?void 0:w.toString())||"0",carried_over:((q=s==null?void 0:s.carried_over)==null?void 0:q.toString())||"0",allow_custom_settings:(s==null?void 0:s.allow_custom_settings)||!1});H.useEffect(()=>{if(l.leave_settings_template_id&&!i){const e=h.find(j=>j.id.toString()===l.leave_settings_template_id);e&&(r(j=>{var U,k,A,D;return{...j,accrual_type:e.accrual_type.toString(),accrual_frequency:((U=e.accrual_frequency)==null?void 0:U.toString())||"",accrual_amount:((k=e.accrual_amount)==null?void 0:k.toString())||"",max_cap:((A=e.max_cap)==null?void 0:A.toString())||"",max_carry_over:((D=e.max_carry_over)==null?void 0:D.toString())||"0"}}),m.info(`Fields auto-populated from template: ${e.name}`))}},[l.leave_settings_template_id,h,i,r]);const O=e=>{e.preventDefault(),i&&s?I(route("user-leave-settings.update",s.id),{onSuccess:()=>{m.success("User leave setting updated successfully")},onError:()=>{m.error("Failed to update user leave setting")}}):E(route("user-leave-settings.store"),{onSuccess:()=>{m.success("User leave setting created successfully"),M()},onError:()=>{m.error("Failed to create user leave setting")}})},d=!l.allow_custom_settings&&!!l.leave_settings_template_id;return a.jsx("form",{onSubmit:O,className:"space-y-6",children:a.jsxs($,{children:[a.jsx(G,{children:a.jsx(J,{children:i?"Edit User Leave Setting":"Create User Leave Setting"})}),a.jsxs(K,{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"user_id",children:"User *"}),a.jsxs(n,{value:l.user_id,onValueChange:e=>r("user_id",e),children:[a.jsx(_,{children:a.jsx(x,{placeholder:"Select a user"})}),a.jsx(p,{children:T.map(e=>a.jsxs(u,{value:e.id.toString(),children:[e.first_name," ",e.last_name," (",e.email,")"]},e.id))})]}),c.user_id&&a.jsx("p",{className:"text-destructive text-sm",children:c.user_id})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"leave_settings_template_id",children:"Leave Settings Template *"}),a.jsxs(n,{value:l.leave_settings_template_id,onValueChange:e=>r("leave_settings_template_id",e),children:[a.jsx(_,{children:a.jsx(x,{placeholder:"Select a template"})}),a.jsx(p,{children:h.map(e=>a.jsxs(u,{value:e.id.toString(),children:[e.name," (",e.leave_type.name,")"]},e.id))})]}),c.leave_settings_template_id&&a.jsx("p",{className:"text-destructive text-sm",children:c.leave_settings_template_id})]})]}),l.leave_settings_template_id&&a.jsxs("div",{className:"rounded-md border border-blue-200 bg-blue-50 p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(P,{id:"allow_custom_settings",checked:l.allow_custom_settings,className:"border-blue-500 data-[state=checked]:bg-blue-500 data-[state=checked]:text-white",onCheckedChange:e=>r("allow_custom_settings",!!e)}),a.jsx(t,{htmlFor:"allow_custom_settings",className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Allow custom settings (enable editing of template fields)"})]}),!l.allow_custom_settings&&a.jsx("p",{className:"mt-2 text-sm text-blue-600",children:"Template fields are locked. Check the box above to customize these values."})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"start_date",children:"Start Date *"}),a.jsx(o,{id:"start_date",type:"date",value:l.start_date,onChange:e=>r("start_date",e.target.value),required:!0}),c.start_date&&a.jsx("p",{className:"text-destructive text-sm",children:c.start_date})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"end_date",children:"End Date"}),a.jsx(o,{id:"end_date",type:"date",value:l.end_date,onChange:e=>r("end_date",e.target.value)}),c.end_date&&a.jsx("p",{className:"text-destructive text-sm",children:c.end_date})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"accrual_type",children:"Accrual Type *"}),a.jsxs(n,{value:l.accrual_type,onValueChange:e=>r("accrual_type",e),disabled:d,children:[a.jsx(_,{className:d?"cursor-not-allowed opacity-50":void 0,children:a.jsx(x,{placeholder:"Select accrual type"})}),a.jsx(p,{children:V.map(e=>a.jsx(u,{value:e.value.toString(),children:e.label},e.value))})]}),c.accrual_type&&a.jsx("p",{className:"text-destructive text-sm",children:c.accrual_type})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"accrual_frequency",children:"Accrual Frequency"}),a.jsxs(n,{value:l.accrual_frequency,onValueChange:e=>r("accrual_frequency",e),disabled:d,children:[a.jsx(_,{className:d?"cursor-not-allowed opacity-50":"",children:a.jsx(x,{placeholder:"Select frequency"})}),a.jsx(p,{children:B.map(e=>a.jsx(u,{value:e.value.toString(),children:e.label},e.value))})]}),c.accrual_frequency&&a.jsx("p",{className:"text-destructive text-sm",children:c.accrual_frequency})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"accrual_amount",children:"Accrual Amount"}),a.jsx(o,{id:"accrual_amount",type:"number",step:"0.01",value:l.accrual_amount,onChange:e=>r("accrual_amount",e.target.value),disabled:d,className:d?"cursor-not-allowed opacity-50":""}),c.accrual_amount&&a.jsx("p",{className:"text-destructive text-sm",children:c.accrual_amount})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"max_cap",children:"Max Cap *"}),a.jsx(o,{id:"max_cap",type:"number",step:"0.01",value:l.max_cap,onChange:e=>r("max_cap",e.target.value),required:!0,disabled:d,className:d?"cursor-not-allowed opacity-50":""}),c.max_cap&&a.jsx("p",{className:"text-destructive text-sm",children:c.max_cap})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"max_carry_over",children:"Max Carry Over"}),a.jsx(o,{id:"max_carry_over",type:"number",step:"0.01",value:l.max_carry_over,onChange:e=>r("max_carry_over",e.target.value),disabled:d,className:d?"cursor-not-allowed opacity-50":""}),c.max_carry_over&&a.jsx("p",{className:"text-destructive text-sm",children:c.max_carry_over})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"current_balance",children:"Current Balance"}),a.jsx(o,{id:"current_balance",type:"number",step:"0.01",value:l.current_balance,onChange:e=>r("current_balance",e.target.value)}),c.current_balance&&a.jsx("p",{className:"text-destructive text-sm",children:c.current_balance})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(t,{htmlFor:"carried_over",children:"Carried Over"}),a.jsx(o,{id:"carried_over",type:"number",step:"0.01",value:l.carried_over,onChange:e=>r("carried_over",e.target.value)}),c.carried_over&&a.jsx("p",{className:"text-destructive text-sm",children:c.carried_over})]})]}),a.jsx("div",{className:"flex items-center justify-end gap-4",children:a.jsx(R,{type:"submit",disabled:y,children:y?"Saving...":i?"Update":"Create"})})]})]})})}export{aa as U};
