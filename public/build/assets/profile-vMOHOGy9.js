import{K as F,r as u,m as S,j as e,L as k,$ as C,S as w}from"./app-C84IgD_F.js";import{S as D,H as _}from"./layout-BZe54BsI.js";import{I as j}from"./input-error-B2KvTMl2.js";import{m as P,n as E,o as L}from"./admin-layout-D-T6yGF_.js";import{B as b}from"./createLucideIcon-1iKnX0P3.js";import{I as N}from"./input-DsAprXuv.js";import{L as y}from"./label-DtNMNcRI.js";import{A as $}from"./app-layout-BDvouAMc.js";import{z as I}from"./transition-DAqWIXRQ.js";/* empty css            */import"./heading-CjrVVoYU.js";import"./index-BwlO7WIz.js";import"./applicationLogo-C_OBQ510.js";import"./index-Cw9X1wRV.js";const U=[{title:"Profile settings",href:"/settings/profile"}],R=({avatarThumbUrl:x,user:i})=>{const[n,p]=u.useState(null),[c,o]=u.useState(!1),[t,a]=u.useState(null),r=u.useRef(null),h=`${i.first_name} ${i.last_name}`.trim(),m=s=>{s.target.files&&s.target.files[0]&&(p(s.target.files[0]),a(null))},v=async s=>{if(s.preventDefault(),!!n){o(!0),a(null);try{const d=new FormData;d.append("avatar",n),w.post(route("profile.update.avatar"),d,{forceFormData:!0,onSuccess:()=>{r.current&&(r.current.value=""),p(null)},onError:f=>{console.error("Avatar upload error:",f),f.avatar?a(f.avatar):a("An error occurred while uploading the avatar.")},onFinish:()=>{o(!1)}})}catch(d){console.error("Avatar upload error:",d),a("An unexpected error occurred."),o(!1)}}},g=()=>{var s;(s=r.current)==null||s.click()};return e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs(P,{className:"h-24 w-24",children:[e.jsx(E,{className:"object-cover",src:x,alt:`${h}'s avatar`}),e.jsx(L,{children:`${i.first_name.charAt(0)}${i.last_name.charAt(0)}`})]})}),e.jsxs("div",{className:"mt-4 sm:mt-0",children:[e.jsx(b,{type:"button",variant:"outline",onClick:g,className:"mr-4",children:"Choose image"}),e.jsx("input",{type:"file",ref:r,className:"hidden",onChange:m,accept:"image/*"}),n&&e.jsxs("span",{className:"text-sm text-neutral-600",children:["Selected: ",n.name]})]})]}),t&&e.jsx("div",{className:"rounded-md bg-red-50 p-4 text-sm text-red-700",children:t}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(b,{type:"submit",disabled:c||!n,children:c?"Uploading...":"Save Avatar"})})]})};function se({mustVerifyEmail:x,status:i,avatarUrl:n,avatarThumbUrl:p,message:c,error:o}){const{auth:t}=F().props;u.useRef(null);const{data:a,setData:r,patch:h,errors:m,processing:v,recentlySuccessful:g}=S({first_name:t.user.first_name,last_name:t.user.last_name,email:t.user.email}),{data:s,setData:d,patch:f,errors:q,processing:z,recentlySuccessful:B,progress:H}=S({avatar:null}),A=l=>{l.preventDefault(),h(route("profile.update"),{preserveScroll:!0})};return e.jsxs($,{breadcrumbs:U,children:[e.jsx(k,{title:"Profile settings"}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{title:"Profile Picture",description:"Update your profile picture"}),c&&e.jsx("div",{className:"rounded-md bg-green-50 p-4 text-sm text-green-700",children:c}),o&&e.jsx("div",{className:"rounded-md bg-red-50 p-4 text-sm text-red-700",children:o}),e.jsx(R,{avatarThumbUrl:p,user:t.user})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{title:"Profile information",description:"Update your name and email address"}),e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"first_name",children:"First name"}),e.jsx(N,{id:"first_name",className:"mt-1 block w-full",value:a.first_name,onChange:l=>r("first_name",l.target.value),required:!0,autoComplete:"given-name",placeholder:"First name"}),e.jsx(j,{className:"mt-2",message:m.first_name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"last_name",children:"Last name"}),e.jsx(N,{id:"last_name",className:"mt-1 block w-full",value:a.last_name,onChange:l=>r("last_name",l.target.value),required:!0,autoComplete:"family-name",placeholder:"Last name"}),e.jsx(j,{className:"mt-2",message:m.last_name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"email",children:"Email address"}),e.jsx(N,{id:"email",type:"email",className:"mt-1 block w-full",value:a.email,onChange:l=>r("email",l.target.value),required:!0,autoComplete:"username",placeholder:"Email address"}),e.jsx(j,{className:"mt-2",message:m.email})]}),x&&t.user.email_verified_at===null&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-muted-foreground -mt-4 text-sm",children:["Your email address is unverified."," ",e.jsx(C,{href:route("verification.send"),method:"post",as:"button",className:"text-foreground underline decoration-neutral-300 underline-offset-4 transition-colors duration-300 ease-out hover:decoration-current! dark:decoration-neutral-500",children:"Click here to resend the verification email."})]}),i==="verification-link-sent"&&e.jsx("div",{className:"mt-2 text-sm font-medium text-green-600",children:"A new verification link has been sent to your email address."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{disabled:v,children:"Save Profile"}),e.jsx(I,{show:g,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-neutral-600",children:"Saved"})})]})]})]})]})})]})}export{se as default};
