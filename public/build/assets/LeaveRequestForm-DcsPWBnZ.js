import{m as g,r as f,j as e}from"./app-C84IgD_F.js";import{B as h}from"./createLucideIcon-1iKnX0P3.js";import{C as b,a as N,b as S,c as v,d as C}from"./card-D2SlVg6H.js";import{I as x}from"./input-DsAprXuv.js";import{L as i}from"./label-DtNMNcRI.js";import{S as w,a as D,b as T,c as L,d as F}from"./select-gXvW7wEd.js";import{T as I}from"./textarea-DvXYkZiG.js";function U({leaveRequest:t,userLeaveSettings:c,mode:o}){const{data:s,setData:r,post:u,put:p,processing:_,errors:d}=g({user_leave_setting_id:(t==null?void 0:t.user_leave_setting_id)||"",start_date:(t==null?void 0:t.start_date)||"",end_date:(t==null?void 0:t.end_date)||"",days_requested:(t==null?void 0:t.days_requested)||0,reason:(t==null?void 0:t.reason)||""});f.useEffect(()=>{if(s.start_date&&s.end_date){const a=new Date(s.start_date),l=new Date(s.end_date).getTime()-a.getTime(),y=Math.ceil(l/(1e3*60*60*24))+1;r("days_requested",Math.max(0,y))}},[s.start_date,s.end_date]);const j=a=>{a.preventDefault(),o==="create"?u(route("leave-requests.store")):p(route("leave-requests.update",t==null?void 0:t.id))},n=c.find(a=>a.id.toString()===s.user_leave_setting_id.toString());return e.jsx("form",{onSubmit:j,children:e.jsxs(b,{children:[e.jsx(N,{children:e.jsx(S,{children:o==="create"?"Request Leave":"Edit Leave Request"})}),e.jsxs(v,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"user_leave_setting_id",children:"Leave Type"}),c.length===0?e.jsxs("div",{className:"rounded-md bg-yellow-50 p-4",children:[e.jsx("h4",{className:"font-medium text-yellow-900",children:"No Leave Settings Available"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"You don't have any leave settings configured. Please contact your administrator to set up your leave entitlements."})]}):e.jsxs(w,{value:s.user_leave_setting_id.toString(),onValueChange:a=>r("user_leave_setting_id",parseInt(a)),children:[e.jsx(D,{children:e.jsx(T,{placeholder:"Select leave type"})}),e.jsx(L,{children:c.map(a=>{var m,l;return e.jsxs(F,{value:a.id.toString(),children:[((l=(m=a.leave_settings_template)==null?void 0:m.leave_type)==null?void 0:l.name)||"Unknown Leave Type"," - Balance:"," ",a.current_balance," days"]},a.id)})})]}),d.user_leave_setting_id&&e.jsx("p",{className:"text-sm text-red-600",children:d.user_leave_setting_id})]}),n&&e.jsxs("div",{className:"rounded-md bg-blue-50 p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Leave Balance Information"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Current Balance: ",e.jsxs("span",{className:"font-medium",children:[n.current_balance," days"]})]}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Maximum Cap: ",e.jsxs("span",{className:"font-medium",children:[n.max_cap," days"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"start_date",children:"Start Date"}),e.jsx(x,{id:"start_date",type:"date",value:s.start_date,onChange:a=>r("start_date",a.target.value),min:new Date().toISOString().split("T")[0]}),d.start_date&&e.jsx("p",{className:"text-sm text-red-600",children:d.start_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"end_date",children:"End Date"}),e.jsx(x,{id:"end_date",type:"date",value:s.end_date,onChange:a=>r("end_date",a.target.value),min:s.start_date||new Date().toISOString().split("T")[0]}),d.end_date&&e.jsx("p",{className:"text-sm text-red-600",children:d.end_date})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"days_requested",children:"Days Requested"}),e.jsx(x,{id:"days_requested",type:"number",step:"0.5",value:s.days_requested,onChange:a=>r("days_requested",parseFloat(a.target.value)||0),min:"0.5"}),d.days_requested&&e.jsx("p",{className:"text-sm text-red-600",children:d.days_requested}),e.jsx("p",{className:"text-sm text-gray-600",children:"Days are automatically calculated based on start and end dates. You can adjust manually if needed."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"reason",children:"Reason"}),e.jsx(I,{id:"reason",value:s.reason,onChange:a=>r("reason",a.target.value),placeholder:"Please provide a reason for your leave request...",rows:4}),d.reason&&e.jsx("p",{className:"text-sm text-red-600",children:d.reason})]}),s.days_requested>0&&n&&s.days_requested>n.current_balance&&e.jsxs("div",{className:"rounded-md bg-red-50 p-4",children:[e.jsx("h4",{className:"font-medium text-red-900",children:"Insufficient Balance"}),e.jsxs("p",{className:"text-sm text-red-700",children:["You are requesting ",s.days_requested," days but only have ",n.current_balance," days available."]})]})]}),e.jsxs(C,{className:"flex justify-end space-x-2",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>window.history.back(),children:"Cancel"}),e.jsx(h,{type:"submit",disabled:_,children:_?"Submitting...":o==="create"?"Submit Request":"Update Request"})]})]})})}export{U as L};
